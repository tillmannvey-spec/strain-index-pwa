<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#11150f">
  <title>Strain Index</title>
  <link rel="manifest" href="./manifest.webmanifest">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&family=Sora:wght@500;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <div class="ambient"></div>
  <div class="app-shell">
    <header class="hero">
      <div>
        <p class="eyebrow">Personal PWA</p>
        <h1>Medical Cannabis Strain Index</h1>
        <p class="subtitle">Dashboard first. Danach getrennte Seiten fuer Strain-Uebersicht und Profile.</p>
      </div>
      <div class="hero-actions">
        <button class="primary-btn" id="importBtn">Text importieren</button>
        <button class="primary-btn" id="addStrainBtn">Neuen Strain</button>
      </div>
    </header>

    <main class="mobile-pages">
      <section id="dashboardView" data-view="dashboard" class="page-view">
        <div class="page-head">
          <h2>Dashboard</h2>
          <span id="strainCount" class="counter">0 Strains</span>
        </div>
        <section class="search-row">
          <input id="searchInput" type="search" placeholder="Strain suchen...">
          <button type="button" id="toggleFilterBtn" class="ghost-btn icon-btn" aria-label="Filter anzeigen" aria-expanded="false">
            <span class="material-symbols-outlined">tune</span>
          </button>
        </section>
        <section id="filterPanel" class="toolbar" hidden>
          <select id="manufacturerFilter"></select>
          <select id="effectFilter"></select>
          <select id="medicalFilter"></select>
        </section>
        <section class="panel">
          <h3>Aktuelle Treffer</h3>
          <div id="dashboardGrid" class="strain-grid"></div>
        </section>
      </section>

      <section id="strainsView" data-view="strains" class="page-view" hidden>
        <div class="page-head">
          <h2>Strains</h2>
          <p>Gesamte Uebersicht aller gespeicherten Strains</p>
        </div>
        <section class="panel">
          <div id="strainGrid" class="strain-grid"></div>
        </section>
      </section>

      <section id="profileView" data-view="profile" class="page-view" hidden>
        <div class="page-head">
          <h2>Profile</h2>
          <p>Detailansicht eines ausgewaehlten Strains</p>
        </div>

        <aside id="profilePanel" class="panel profile-column"></aside>

        <section class="panel settings-box">
          <h3>Gemini Import</h3>
          <label class="checkbox-row">
            <input type="checkbox" id="settingsUseLlm">
            <span>Gemini fuer automatische Zuordnung nutzen</span>
          </label>
          <label>API Key<input id="settingsApiKey" type="password" placeholder="AIza..."></label>
          <label>Model<input id="settingsModel" type="text" placeholder="gemini-3-flash-preview"></label>
          <label>Endpoint<input id="settingsEndpoint" type="url" placeholder="https://generativelanguage.googleapis.com/v1beta"></label>
          <button type="button" class="ghost-btn small" id="saveSettingsBtn">Import-Einstellungen speichern</button>
          <p id="importStatus" class="status-line"></p>
        </section>
      </section>
    </main>

    <nav class="bottom-nav">
      <button type="button" class="nav-btn active" data-nav-view="dashboard">
        <span class="material-symbols-outlined">home</span>
        <span>Dashboard</span>
      </button>
      <button type="button" class="nav-btn" data-nav-view="strains">
        <span class="material-symbols-outlined">deployed_code</span>
        <span>Strains</span>
      </button>
      <button type="button" class="nav-btn" data-nav-view="profile">
        <span class="material-symbols-outlined">person</span>
        <span>Profile</span>
      </button>
    </nav>
  </div>

  <dialog id="strainDialog" class="modal">
    <form id="strainForm" class="modal-form">
      <header class="modal-header">
        <h2>Strain-Profil</h2>
        <button type="button" class="ghost-btn small" data-close-dialog>Schliessen</button>
      </header>
      <div class="field-grid">
        <label>Name<input required name="name" type="text"></label>
        <label>Hersteller<input name="manufacturer" type="text"></label>
        <label>Genetik<input name="genetics" type="text"></label>
        <label>THC<input name="thc" type="text" placeholder="z.B. 22%"></label>
        <label>CBD<input name="cbd" type="text" placeholder="z.B. 0.7%"></label>
        <label class="full">Anbau<input name="cultivation" type="text" placeholder="z.B. unbestrahlt, Kanada"></label>
        <label class="full">Wirkungsprofil<input name="effects" type="text" placeholder="Euphorisch, Kreativ"></label>
        <label class="full">Geschmack/Aroma<input name="aromaFlavor" type="text" placeholder="Beere, Erde"></label>
        <label class="full">Gesamtwirkung<textarea name="overallEffect" rows="2"></textarea></label>
        <label>Onset & Dauer<input name="onsetDuration" type="text" placeholder="Onset 8 min / Dauer 3 h"></label>
        <label>Characteristic<input name="characteristic" type="text"></label>
        <label class="full">Medizinische Anwendungen<input name="medicalApplications" type="text" placeholder="Schmerz, Stress"></label>
        <label class="full">Community-Feedback<textarea name="communityFeedback" rows="3"></textarea></label>
        <label class="full">Notizen<textarea name="notes" rows="3"></textarea></label>
      </div>

      <section class="terpene-section">
        <h3>Terpenprofil</h3>
        <div id="terpeneRows" class="terpene-rows"></div>
        <button type="button" class="ghost-btn small" id="addTerpeneBtn">Terpen hinzufuegen</button>
      </section>

      <section class="image-section">
        <label>Profilbild
          <input id="imageInput" type="file" accept="image/*">
          <input id="imageValue" type="hidden">
        </label>
        <img id="imagePreview" class="preview hidden" alt="Vorschau Profilbild">
      </section>

      <footer class="modal-footer">
        <button type="button" class="ghost-btn" data-close-dialog>Abbrechen</button>
        <button type="submit" class="primary-btn">Profil speichern</button>
      </footer>
    </form>
  </dialog>

  <dialog id="importDialog" class="modal">
    <form id="importForm" class="modal-form">
      <header class="modal-header">
        <h2>Strain importieren</h2>
        <button type="button" class="ghost-btn small" data-close-dialog>Schliessen</button>
      </header>
      <label>Import-Text
        <textarea id="importText" name="importText" rows="14" placeholder="Freitext oder strukturierter Text..."></textarea>
      </label>
      <footer class="modal-footer">
        <button type="button" class="ghost-btn" data-close-dialog>Abbrechen</button>
        <button type="submit" class="primary-btn">Text analysieren</button>
      </footer>
    </form>
  </dialog>

  <script type="module" src="./src/app.js"></script>
</body>
</html>
